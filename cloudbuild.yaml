steps:
- name: "gcr.io/cloud-builders/npm"
  args: ["install"]
  dir: "/workspace/myapp"  # Specify the correct directory where package.json is located

- name: "gcr.io/cloud-builders/npm"
  args: ["test"]
  dir: "/workspace/myapp/tests"  # Make sure to use the same directory for testing

- name: 'gcr.io/cloud-builders/gcloud'
    args: ['app', 'deploy']
    env:
      - 'CLOUDSDK_CORE_PROJECT=my-project-51512-402616'
    dir: '/workspace/myapp'
    serviceAccount: 'cloudbuild-sa@my-project-51512-402616.iam.gserviceaccount.com'

# Add other steps as needed